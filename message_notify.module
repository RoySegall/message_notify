<?php

/**
 * @file
 * Message notify.
 */
use Drupal\message_notify\MessageNotify;

/**
 * Implements hook_entity_view_mode_info_alter().
 *
 * Add a the notifiers view modes.
 */
function message_notify_entity_view_mode_info_alter(&$view_modes) {
  $notifiers = MessageNotify::GetNotifiers();

  foreach ($notifiers as $notifier) {
    $plugin_view_modes = $notifier['view_modes'];

    foreach ($plugin_view_modes as $type => $view_mode) {
      $view_modes['message'][$type] = array(
        'label' => $view_mode->render(),
        'status' => TRUE,
        'cache' => TRUE,
      );
    }
  }
}

/**
 * Implements hook_mail().
 *
 * Set's the message subject and body as configured.
 */
function message_notify_mail($key, &$message, $params) {
  // Get from the
  $message['subject'] = 'foo';
  $message['body'][] = 'bar';
}
